<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>文字編輯器</title>
    <link href="src/img/icon.png" rel="shortcut icon" />

    <script src="src/lib/jquery/jquery-3.6.0.js"></script>
    <script src="src/lib/bootstrap -v5/js/bootstrap.js"></script>
    <link href="src/lib/bootstrap -v5/css/bootstrap.css" rel="stylesheet">
    <script src="src/lib/bootstrap -v5/js/bootstrap.min.js"></script>

    <script src="src/lib/simple-keyboard -v3.4/simple-keyboard/build/index.js"></script>
    <link rel="stylesheet" href="src/lib/simple-keyboard -v3.4/simple-keyboard/build/css/index.css">

    <script src="src/lib/function.js"></script>

    <script src="src/lib/UndoRedo.js -v1.2.0/src/UndoRedo.js"></script>
    <script src="src/lib/FileSaver.js/FileSaver.js"></script>

    <script src="src/lib/Toast -v1.1/Toast.js"></script>
    <link href="src/lib/Toast -v1.1/Toast.css" rel="stylesheet">

    <link rel="stylesheet" href="src/style/main.css">
</head>

<body style="margin: 8px;">

    <!---------------Loading-UI----------------->
    <div id="loading">

        <img src="src/img/icon.png" style="max-width: 15vw; ">


    </div>
    <noscript>
        <div class="alert alert-danger" role="alert">
            本程式需要JavaScript才能正確執行，請先開啟JavaScript!
        </div>
        <style>
            nav,
            button,
            input,
            .tab-content {
                display: none;
            }
        </style>
    </noscript>



    <div>
        <center style="user-select:none ;" ondblclick="rename_for_modal()">
            <span id="unsaved-mark"></span><span title="連按兩下以重新命名"
                class="file-name rename-display">未命名.txt</span>&nbsp;-文字編輯器
        </center>
        <!--<center>
            <input type="text" style="display: none;" id="rename-center" placeholder="重新命名...">
            <select id="file-sec-name-center" style="display: none;">
                <option value=".txt">.txt</option>
                <option value=".csv">.csv</option>
                </option>
            </select>
            <button class="btn " title="確定" style="display: none;" id="rename-center-closebtn"
                onclick="Rename();$('#rename-center').hide();$('#file-sec-name-center').hide();$(this).hide()">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                    class="bi bi-check-circle" viewBox="0 0 16 16">
                    <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z" />
                    <path
                        d="M10.97 4.97a.235.235 0 0 0-.02.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-1.071-1.05z" />
                </svg>
            </button><span id="rename-center-tooltip"></span>
        </center>-->
        <nav>
            <div class="nav nav-tabs" id="nav-tab" role="tablist">

                <button class="nav-link " id="nav-0-tab" type="button" role="button" aria-selected="false"
                    style="background-color: #0099ff; color:#fff;" data-bs-toggle="offcanvas"
                    data-bs-target="#offcanvasExample" aria-controls="offcanvasExample">

                    檔案
                </button>



                <button class="nav-link active" id="nav-1-tab" data-bs-toggle="tab" data-bs-target="#nav-1"
                    type="button" role="tab" aria-controls="nav-1" aria-selected="true">
                    編輯

                </button>


                <button class="nav-link" id="nav-6-tab" data-bs-toggle="tab" data-bs-target="#nav-6" type="button"
                    role="tab" aria-controls="nav-6" aria-selected="false">
                    檢視
                </button>
            </div>
        </nav>


        <div class="tab-content" id="nav-tabContent" style="width: 100%; ">
            <div class="tab-pane fade show active" id="nav-1" role="tabpanel" aria-labelledby="nav-1-tab">
                <div style="display:flex ; user-select: none;">
                    <div style="text-align: center;">
                        <span style="font-size:1.25em;">動作</span><br>
                        <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="currentColor" title="復原"
                            class="bi bi-arrow-counterclockwise" viewBox="0 0 16 16" id="undo">
                            <path fill-rule="evenodd"
                                d="M8 3a5 5 0 1 1-4.546 2.914.5.5 0 0 0-.908-.417A6 6 0 1 0 8 2v1z" />
                            <path
                                d="M8 4.466V.534a.25.25 0 0 0-.41-.192L5.23 2.308a.25.25 0 0 0 0 .384l2.36 1.966A.25.25 0 0 0 8 4.466z" />
                        </svg>
                        <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="currentColor" title="取消復原"
                            class="bi bi-arrow-clockwise" viewBox="0 0 16 16" id="redo">
                            <path fill-rule="evenodd"
                                d="M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2v1z" />
                            <path
                                d="M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466z" />
                        </svg>
                    </div>

                    <div class="vh" style="margin-top: 2.5px; margin-left: 5px; margin-right: 5px;">
                        <center> <img src="src/img/vh-50.png"></center>
                    </div>
                    <div style="text-align: center; ">
                        <span style="font-size:1.25em;">csv功能</span><br>
                        <div style="display: flex;">
                            新增<select id="csvtool-select">
                                <option value="row">行(↲)</option>
                                <option value="col">列( , )</option>
                            </select>
                            <button class="btn " title="確定" style="padding-top: 0; padding-bottom: 0;" onclick="                            
                        if($('#csvtool-select').val() == 'col'){
                            textarea.val(textarea.val()+',')}
                        else{textarea.val(textarea.val()+'\n')};

                        if(filename.includes('.txt')){
                            Toast.toast('請將檔案另存成.csv檔案',5000)
                        }
                        use_csvtools = true;
                        dirty();">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                                    style="margin-top:0 ;" class="bi bi-check-circle" viewBox="0 0 16 16">
                                    <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z" />
                                    <path
                                        d="M10.97 4.97a.235.235 0 0 0-.02.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-1.071-1.05z" />
                                </svg>
                            </button>


                        </div>
                    </div>
                    <div class="vh" style="margin-top: 2.5px; margin-left: 5px; margin-right: 5px;">
                        <center> <img src="src/img/vh-50.png"></center>
                    </div>
                </div>

            </div>
            <div class="tab-pane fade" id="nav-6" role="tabpanel" aria-labelledby="nav-6-tab">


                <div style="display:flex ; user-select: none;">
                    <div style="text-align: center;">
                        <span style="font-size:1.25em;">預覽</span><br>
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                            class="bi bi-app" viewBox="0 0 16 16">
                            <path
                                d="M11 2a3 3 0 0 1 3 3v6a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3V5a3 3 0 0 1 3-3h6zM5 1a4 4 0 0 0-4 4v6a4 4 0 0 0 4 4h6a4 4 0 0 0 4-4V5a4 4 0 0 0-4-4H5z" />
                        </svg>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <center>
        <textarea style="margin-top: 5px;" id="textarea"></textarea>
    </center>
    <!-------------------------Modal & offcanvas------------------------------>

    <div style="width: 100%;" class="offcanvas offcanvas-start" tabindex="-1" id="offcanvasExample"
        aria-labelledby="offcanvasExampleLabel">


        <h1 style="margin-left: 10px;">
            <button type="button" class=" btn-no-outline btn " data-bs-dismiss="offcanvas" aria-label="Close"
                onclick="$(this).css('outline','0')" onfocus="$(this).css('outline','0')">
                <svg xmlns="http://www.w3.org/2000/svg" width="35" height="35" fill="currentColor"
                    class="bi bi-arrow-left-circle" viewBox="0 0 16 16">
                    <path fill-rule="evenodd"
                        d="M1 8a7 7 0 1 0 14 0A7 7 0 0 0 1 8zm15 0A8 8 0 1 1 0 8a8 8 0 0 1 16 0zm-4.5-.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H11.5z" />
                </svg>
            </button>
        </h1>
        <div class="offcanvas-body">
            <div class="d-flex align-items-start">
                <div class="nav flex-column nav-pills me-3" id="v-pills-tab" role="tablist" aria-orientation="vertical">
                    <button class="nav-link active" id="v-pills-home-tab" data-bs-toggle="pill"
                        data-bs-target="#v-pills-home" type="button" role="tab" aria-controls="v-pills-home"
                        aria-selected="true">
                        <h2>
                            <center>
                                <svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" fill="currentColor"
                                    class="bi bi-file-earmark" viewBox="0 0 16 16">
                                    <path
                                        d="M14 4.5V14a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h5.5L14 4.5zm-3 0A1.5 1.5 0 0 1 9.5 3V1H4a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V4.5h-2z" />
                                </svg>
                            </center>

                            <b>常用</b>
                        </h2>
                    </button>
                    <button class="nav-link" id="v-pills-profile-tab" data-bs-toggle="pill"
                        data-bs-target="#v-pills-profile" type="button" role="tab" aria-controls="v-pills-profile"
                        aria-selected="false">
                        <h2>
                            <center>

                                <svg xmlns="http://www.w3.org/2000/svg" width="50" height="50 " fill="currentColor"
                                    class="bi bi-gear" viewBox="0 0 16 16">
                                    <path
                                        d="M8 4.754a3.246 3.246 0 1 0 0 6.492 3.246 3.246 0 0 0 0-6.492zM5.754 8a2.246 2.246 0 1 1 4.492 0 2.246 2.246 0 0 1-4.492 0z" />
                                    <path
                                        d="M9.796 1.343c-.527-1.79-3.065-1.79-3.592 0l-.094.319a.873.873 0 0 1-1.255.52l-.292-.16c-1.64-.892-3.433.902-2.54 2.541l.159.292a.873.873 0 0 1-.52 1.255l-.319.094c-1.79.527-1.79 3.065 0 3.592l.319.094a.873.873 0 0 1 .52 1.255l-.16.292c-.892 1.64.901 3.434 2.541 2.54l.292-.159a.873.873 0 0 1 1.255.52l.094.319c.527 1.79 3.065 1.79 3.592 0l.094-.319a.873.873 0 0 1 1.255-.52l.292.16c1.64.893 3.434-.902 2.54-2.541l-.159-.292a.873.873 0 0 1 .52-1.255l.319-.094c1.79-.527 1.79-3.065 0-3.592l-.319-.094a.873.873 0 0 1-.52-1.255l.16-.292c.893-1.64-.902-3.433-2.541-2.54l-.292.159a.873.873 0 0 1-1.255-.52l-.094-.319zm-2.633.283c.246-.835 1.428-.835 1.674 0l.094.319a1.873 1.873 0 0 0 2.693 1.115l.291-.16c.764-.415 1.6.42 1.184 1.185l-.159.292a1.873 1.873 0 0 0 1.116 2.692l.318.094c.835.246.835 1.428 0 1.674l-.319.094a1.873 1.873 0 0 0-1.115 2.693l.16.291c.415.764-.42 1.6-1.185 1.184l-.291-.159a1.873 1.873 0 0 0-2.693 1.116l-.094.318c-.246.835-1.428.835-1.674 0l-.094-.319a1.873 1.873 0 0 0-2.692-1.115l-.292.16c-.764.415-1.6-.42-1.184-1.185l.159-.291A1.873 1.873 0 0 0 1.945 8.93l-.319-.094c-.835-.246-.835-1.428 0-1.674l.319-.094A1.873 1.873 0 0 0 3.06 4.377l-.16-.292c-.415-.764.42-1.6 1.185-1.184l.292.159a1.873 1.873 0 0 0 2.692-1.115l.094-.319z" />
                                </svg>

                            </center>
                            <b>設定</b>
                        </h2>
                    </button>

                </div>
                <div class="tab-content" id="v-pills-tabContent">
                    <div class="tab-pane fade show active" id="v-pills-home" role="tabpanel"
                        aria-labelledby="v-pills-home-tab">
                        <h3>檔案</h3>
                        <div id="file-list">

                            <div onclick="PopupAlert('新增專案','如未儲存現有專案，變更將遺失<p>是否新增?</p>','dismiss','NewProject()')"
                                data-bs-dismiss="offcanvas" style="
                display: inline-block; text-align: center; border-radius: 5px; 
                border: 1px solid rgb(59, 59, 59); padding:  15px; user-select: none;">
                                <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor"
                                    class="bi bi-plus-circle" viewBox="0 0 16 16">
                                    <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z" />
                                    <path
                                        d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z" />
                                </svg>
                                <p></p>
                                <h5>新增</h5>

                            </div>

                            <div
                                style="background-color: #8b8b8b; display: inline-block; text-align: center; border-radius: 5px; border: 1px solid rgb(59, 59, 59); padding:  15px; user-select: none;">
                                <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor"
                                    class="bi bi-folder2-open" viewBox="0 0 16 16">
                                    <path
                                        d="M1 3.5A1.5 1.5 0 0 1 2.5 2h2.764c.958 0 1.76.56 2.311 1.184C7.985 3.648 8.48 4 9 4h4.5A1.5 1.5 0 0 1 15 5.5v.64c.57.265.94.876.856 1.546l-.64 5.124A2.5 2.5 0 0 1 12.733 15H3.266a2.5 2.5 0 0 1-2.481-2.19l-.64-5.124A1.5 1.5 0 0 1 1 6.14V3.5zM2 6h12v-.5a.5.5 0 0 0-.5-.5H9c-.964 0-1.71-.629-2.174-1.154C6.374 3.334 5.82 3 5.264 3H2.5a.5.5 0 0 0-.5.5V6zm-.367 1a.5.5 0 0 0-.496.562l.64 5.124A1.5 1.5 0 0 0 3.266 14h9.468a1.5 1.5 0 0 0 1.489-1.314l.64-5.124A.5.5 0 0 0 14.367 7H1.633z" />
                                </svg>
                                <p></p>
                                <h5>開啟</h5>

                            </div>
                            <p></p>
                            <div onclick="download()" data-bs-dismiss="offcanvas" style="
                display: inline-block; text-align: center; border-radius: 5px; 
                border: 1px solid rgb(59, 59, 59); padding:  15px; user-select: none;">
                                <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor"
                                    class="bi bi-download" viewBox="0 0 16 16">
                                    <path
                                        d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z" />
                                    <path
                                        d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z" />
                                </svg>
                                <p></p>
                                <h5>下載</h5>

                            </div>


                        </div>








                    </div>
                    <div class="tab-pane fade" id="v-pills-profile" role="tabpanel"
                        aria-labelledby="v-pills-profile-tab">

                        <h3>關於</h3>

                        <div class="flex" style="user-select: none;">

                            <img src="src/img/icon.png" style="max-height:50px;max-width: 50px;">
                            <pre>
 文字編輯器    
 Jerry - 2022.5
                            </pre>
                        </div>





                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-------------------------Main-script------------------------------------>
    <script>
        //def
        const textarea = $("#textarea");
        textarea.css('width', window.innerWidth - 30 + 'px');
        textarea.css('height', window.innerHeight - 430 + 'px');

        var filename = $(".rename-display").html(),
            use_csvtools = false,
            is_csv = false;
        //dirty
        textarea.on('input', function () {
            dirty()
        });
        textarea.on('change', function () {
            dirty()
        })



        //--------BeforeUnload--Alert---------//
        function dirty() {
            window.isDirty = true;

        }
        window.addEventListener("beforeunload", function (e) {
            if (window.isDirty) {
                (e || window.event).returnValue = ""; // Gecko + IE
                return ""; // Gecko + Webkit, Safari, Chrome etc.
            }

            return undefined;
        });

        //---------------------//
        function Rename() {
            if ($('#rename-center').val() == '') {
                filename = '未命名' + $('#file-sec-name-center').val();
                $('.file-name').html(filename); $('#rename-center').hide(); $('#file-sec-name-center').hide(); $('#rename-center-closebtn').hide();

                rename_istoggle = false;
            } else if ($('#rename-center').val().includes('\ ') || $('#rename-center').val().includes('/') || $('#rename-center').val().includes('<') || $('#rename-center').val().includes('>') || $('#rename-center').val().includes('&') || $('#rename-center').val().includes(':')) {
                Toast.toast('檔案名稱無效', 5000);

            } else {
                filename = $('#rename-center').val() + $('#file-sec-name-center').val();
                $('.file-name').html(filename); $('#rename-center').hide(); $('#file-sec-name-center').hide(); $('#rename-center-closebtn').hide();

                rename_istoggle = false;
            }
        }




    </script>
    <!-------------------------Keyboard-------------------------------------->
    <div class="simple-keyboard"></div>
    <script>
        let Keyboard = window.SimpleKeyboard.default;

        let keyboard = new Keyboard({
            onChange: input => onChange(input),
            onKeyPress: button => onKeyPress(button),
            newLineOnEnter: true,
            tabCharOnTab: true,

            physicalKeyboardHighlight: true,
            preventMouseDownDefault: true
        });

        /**
        * Update simple-keyboard when input is changed directly
        */
        document.querySelector("#textarea").addEventListener("input", event => {
            //  keyboard.setInput(event.target.value);
        });

        console.log(keyboard);

        function onChange(input) {
            //   $("#textarea").val(input);


            if (txtHistory.current() !== textarea.val()) {
                console.log('different')
                // Check for pastes, auto corrects..
                if ((textarea.val().length - txtHistory.current().length) > 1 || (textarea.val().length - txtHistory.current().length) < -1 || (textarea.val().length - txtHistory.current().length) === 0) {
                    // Record the textarea value and force to bypass cooldown
                    txtHistory.record(textarea.val(), true)
                    // Check for single key press, single chacacter paste..
                } else {
                    // Record the textarea value
                    txtHistory.record(textarea.val())
                }
            }
            setTimeout(() => {
                if (textarea.val()) txtHistory.record(textarea.val(), true)
            }, 100)


        }

        function onKeyPress(button) {
            console.log("Button pressed", button);


            if (button === "{enter}") { textarea.val(textarea.val() + "\n"); $("#textarea").focus(); } else
                if (button === "{tab}") { textarea.val(textarea.val() + "\t"); $("#textarea").focus(); } else
                    if (button === "{bksp}") { textarea.val(textarea.val().substring(0, textarea.val().length - 1)); $("#textarea").focus(); } else
                        if (button === "{shift}" || button === "{lock}") { handleShift(); } else
                            if (button === "{space}") {

                                if ($("#textarea").val().length !== 0) {
                                    $("#textarea").val($("#textarea").val() + ' ')
                                } else {
                                    $("#textarea").val(' ')
                                }
                                dirty()

                            }

                            else if (button !== "{tab}" && button !== "{space}" && button !== "{enter}" && button !== "{lock}" && button !== "{shift}" && button !== "{bksp}") {
                                if ($("#textarea").val().length !== 0) {
                                    $("#textarea").val($("#textarea").val() + button)
                                } else {
                                    $("#textarea").val(button)
                                }
                                dirty()



                            }


        }

        function handleShift() {
            let currentLayout = keyboard.options.layoutName;
            let shiftToggle = currentLayout === "default" ? "shift" : "default";

            keyboard.setOptions({
                layoutName: shiftToggle
            });
        }

    </script>
    <!----------------------------------------------------------------------->
    <script>
        // Require the library function
        var txtHistory = new window.UndoRedojs(5)


        // Add event listener for inputs on the textarea
        textarea.on('input', () => {
            // Check if the new textarea value is different
            if (txtHistory.current() !== textarea.value) {
                console.log('different')
                // Check for pastes, auto corrects..
                if ((textarea.val().length - txtHistory.current().length) > 1 || (textarea.val().length - txtHistory.current().length) < -1 || (textarea.val().length - txtHistory.current().length) === 0) {
                    // Record the textarea value and force to bypass cooldown
                    txtHistory.record(textarea.val(), true)
                    // Check for single key press, single chacacter paste..
                } else {
                    // Record the textarea value
                    txtHistory.record(textarea.val())
                }
            }
        })
        // Some browsers will auto-fill the textarea again after reloading, this will deal with that
        setTimeout(() => {
            if (textarea.val()) txtHistory.record(textarea.val(), true)
        }, 100)
        // The undo button
        document.querySelector("#undo").addEventListener('click', () => {
            if (txtHistory.undo(true) !== undefined) {
                textarea.val(txtHistory.undo())
            }
        })
        // The redo button
        document.querySelector("#redo").addEventListener('click', () => {
            if (txtHistory.redo(true) !== undefined) {
                textarea.val(txtHistory.redo())
            }
        })
    </script>
    <!------------------------------Modal+Ctrl----------------------------->
    <div class="modal fade " id="Modal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
        aria-labelledby="ModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable ">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="ModalLabel"></h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">

                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" id="modal-esc-btn">
                        取消
                    </button>
                    <button type="button" class="btn btn-warning" data-bs-dismiss="modal" id="modal-enter-btn">
                        確定
                    </button>

                </div>
            </div>
        </div>
    </div>
    <script>
        function PopupAlert(title, body, escCallBack, enterCallBack) {
            let _Modal = new bootstrap.Modal(document.getElementById('Modal'));
            $('.modal-title').html('');
            $('.modal-body').html('');
            $('#modal-esc-btn').removeAttr('onclick');
            $('#modal-enter-btn').removeAttr('onclick');
            $('#modal-enter-btn').show();
            $('#modal-esc-btn').show();

            //------------------------------------------------//

            $('.modal-title').html(title);
            $('.modal-body').html(body);

            if (escCallBack == 'dismiss') {/**/ }
            else if (escCallBack == 'x') { $('#modal-esc-btn').hide(); console.log("23") }
            else { $('#modal-esc-btn').attr('onclick', escCallBack); }

            if (enterCallBack == 'dismiss') {/**/ }
            else if (enterCallBack == 'x') { $('#modal-enter-btn').hide(); console.log("23") }
            else { $('#modal-enter-btn').attr('onclick', enterCallBack); }


            _Modal.toggle();
        }
    </script>
    <!------------------------------KeyCode + Toggle --------------------------------->
    <script>
        var rename_istoggle = false
        document.onkeydown = function (e) {
            if (e.keyCode == 13) {
                if (rename_istoggle) {
                    Rename()

                }


            }
        }
    </script>
    <!-------------------------Loading-Ctrl---------------------------------->
    <script>
        function delay(n) {
            return new Promise(function (resolve) {
                setTimeout(resolve, n * 1000);
            });
        }

        async function myAsyncFunction() {


            _Offcanvas = new bootstrap.Offcanvas(document.getElementById('offcanvasExample'))
            await delay(2);
            $('#loading').css('opacity', '0');
            await delay(0.5);
            $('#loading').css('display', 'none');
            _Offcanvas.show();



        }


        window.onload =
            myAsyncFunction();


    </script>
</body>

</html>